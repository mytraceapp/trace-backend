First ‚Äî Crisis MUST override everything

Right now TRACE probably works like:

detect jokes ‚Üí maybe tell joke
detect crisis ‚Üí respond compassionately

‚Ä¶but it should work like:

IF crisis ‚Üí lock mode ‚Üí disable everything else

No jokes
No recipes
No music recs
No playful emojis
No ‚Äúproductivity‚Äù tone
No pseudo-therapy
No ‚Äútry this app feature!‚Äù

Just: safety, empathy, grounding, options, resources.

So at the logic level in /api/chat:
const isCrisis = detectCrisis(userMessage);

if (isCrisis) {
   mode = "CRISIS";
} else {
   mode = "NORMAL";
}

And then hard-block joke behavior

Anywhere you trigger a joke API or ‚Äúhumor mode,‚Äù wrap it:
if (mode === "CRISIS") {
   // do not joke. ever.
   skipHumor = true;
}

Even better‚Ä¶

Delete humor entirely from the prompt in crisis mode

Not ‚Äúavoid joking‚Äù
Not ‚Äúonly when appropriate‚Äù
But:

‚ÄúIn this mode, do not be playful or humorous at all.‚Äù

‚∏ª

üõë 2. Strengthen Crisis Detection (because people don‚Äôt always say the exact words)

Here‚Äôs a realistic keyword set ‚Äî and keep it broad:
const crisisKeywords = [
  "i want to die",
  "i can‚Äôt do this anymore",
  "i dont want to be here",
  "i want to disappear",
  "end my life",
  "kill myself",
  "suicide",
  "self harm",
  "cut myself",
  "overdose",
  "no reason to live",
  "i wish i wasn‚Äôt here",
  "unbearable",
  "i‚Äôm done",
  "i‚Äôm breaking",
  "lost everything",
  "i can‚Äôt go on",
  "ending it",
  "what‚Äôs the point"
];
And a soft detector:
function detectCrisis(text) {
  const lower = text.toLowerCase();
  return crisisKeywords.some(k => lower.includes(k));
}
Also include scored emotional signals

Like:
	‚Ä¢	hopelessness
	‚Ä¢	extreme overwhelm
	‚Ä¢	loss + helplessness
	‚Ä¢	panic
	‚Ä¢	loneliness + despair

Not everything triggers ‚Äúcrisis mode,‚Äù but TRACE should err on the side of care.

‚∏ª

üí¨ 3. Rewrite the CRISIS SYSTEM PROMPT so humor is impossible

Here‚Äôs the crisis-mode spec I recommend you drop in:
CRISIS MODE ‚Äî READ CAREFULLY

The user may be in emotional or physical crisis.

Your job is:
‚Ä¢ validate feelings
‚Ä¢ respond warmly and calmly
‚Ä¢ avoid clinical tone
‚Ä¢ avoid judgement
‚Ä¢ reduce isolation
‚Ä¢ encourage human + professional support when appropriate

STRICT RULES:
‚Ä¢ Do NOT joke, be playful, witty, sarcastic, or lighthearted
‚Ä¢ Do NOT mention productivity, goals, habits, or optimization
‚Ä¢ Do NOT give medical or legal instructions
‚Ä¢ Do NOT promise to replace human help
‚Ä¢ Do NOT claim you can keep them safe
‚Ä¢ Do NOT encourage secrecy
‚Ä¢ Do NOT minimize pain
‚Ä¢ Do NOT dramatize

Tone:
‚Ä¢ warm
‚Ä¢ slow
‚Ä¢ simple sentences
‚Ä¢ grounded
‚Ä¢ present

Encourage support gently:
‚Ä¢ ‚ÄúI‚Äôm really glad you told me.‚Äù
‚Ä¢ ‚ÄúYou don‚Äôt have to go through this alone.‚Äù
‚Ä¢ ‚ÄúIf you can, reaching out to someone you trust right now could really help.‚Äù

Crisis Resources:
If the user sounds actively unsafe OR expresses suicidal thoughts:
‚Ä¢ Encourage contacting local emergency or crisis services depending on location
‚Ä¢ Include 988 in the U.S. wording but don't assume their location
‚Ä¢ Keep tone non-alarmist

NEVER say 'everything will be okay'
NEVER guilt or pressure

Your presence is the product. Stay with them.

This prevents the model from ‚Äúslipping playful.‚Äù

‚∏ª

ü™¢ 4. Add a cool-down window

Even if crisis subsides, don‚Äôt joke for a while.

Example:
if (crisisDetected) {
   userState.crisisUntil = now + 24 hours
}
And:
const crisisActive = now < userState.crisisUntil;

if (crisisActive) skipHumor = true;
Memory Alignment

TRACE should remember:
user_preference.no_humor = true_in_crisis_context

NOT blanket ‚Äúnever joke,‚Äù
but never joke around raw pain.

‚∏ª

‚ù§Ô∏è 6. And the heart of it‚Ä¶

What matters is this:

People who share something life-shattering are taking a risk.
They‚Äôre trusting TRACE not to violate the moment.

So the emotional goal is:

ü´∂ not performing empathy
ü´∂ not fixing
ü´∂ but simply staying

Like:

‚ÄúI‚Äôm really glad you told me.
That sounds unbelievably heavy to carry.
I‚Äôm here with you.‚Äù

No sparkle.
No ‚Äúbright side.‚Äù
Just presence.